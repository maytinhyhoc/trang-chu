<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công Cụ - Máy tính y học</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Màu nền nhẹ */
            padding-top: 130px; /* Điều chỉnh padding-top ban đầu, sẽ được JS tính toán lại */
        }
        /* Tùy chỉnh nhỏ cho các phần tử */
        .gradient-bg {
            background: linear-gradient(to right, #6366f1, #a855f7); /* Màu tím xanh */
        }
        .active-link {
            background-color: #e0e7ff; /* Màu nền khi active */
            color: #4f46e5; /* Màu chữ khi active */
            font-weight: 600;
        }
        /* Thêm cuộn ngang cho thanh nav trên mobile */
        .nav-scrollable {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Cho cuộn mượt mà trên iOS */
            scrollbar-width: none; /* Ẩn scrollbar trên Firefox */
        }
        .nav-scrollable::-webkit-scrollbar {
            display: none; /* Ẩn scrollbar trên Chrome/Safari */
        }
        /* Custom styles to ensure consistent font size for labels and radio options */
        .input-group label {
            font-size: 1rem;
        }
        .input-group input[type="radio"] + span {
            font-size: 1rem;
        }
        .score-box {
            background-color: #e0e7ff;
            color: #4f46e5;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 2.5rem;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .result-text {
            font-size: 1.25rem;
            font-weight: 600;
        }
        /* Responsive adjustments for mobile */
        @media (max-width: 767px) { /* Tailwind's 'md' breakpoint is 768px */
            header .logo-text {
                display: none; /* Ẩn logo trên mobile */
            }
            .header-content {
                flex-direction: column; /* Sắp xếp theo cột trên mobile */
                align-items: center; /* Căn giữa các mục trên mobile */
                gap: 0.5rem; /* Giảm khoảng cách giữa các phần */
            }
            .nav-menu {
                justify-content: center; /* Căn giữa menu trên mobile */
                flex-wrap: nowrap; /* Không xuống dòng các link nav */
                padding-bottom: 0.5rem; /* Khoảng cách với thanh tìm kiếm */
                width: 100%; /* Đảm bảo menu chiếm đủ chiều rộng để cuộn */
            }
            .search-bar-container {
                width: calc(100% - 2rem); /* Chiều rộng full trừ padding ngang */
                padding-left: 0; /* Bỏ padding ngang ở đây vì đã tính vào width */
                padding-right: 0;
                margin-top: 0.5rem; /* Khoảng cách với thanh nav */
                margin-left: auto; /* Căn giữa */
                margin-right: auto; /* Căn giữa */
            }
            body {
                padding-top: 100px; /* Adjusted padding for mobile, will be set precisely by JS */
            }
        }
        /* Sửa lỗi zoom khi bấm vào thanh tìm kiếm trên mobile */
        #toolSearch {
            font-size: 16px; /* Đảm bảo font size tối thiểu 16px để ngăn zoom tự động */
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="bg-white shadow-md py-3 fixed top-0 w-full z-20">
        <div class="container mx-auto px-4 header-content flex flex-col md:flex-row md:justify-between md:items-center">
            <div class="flex items-center mb-0 md:flex-shrink-0 md:order-1">
                <a href="#" class="logo-text text-2xl font-bold text-indigo-700 rounded-lg transition duration-300 hover:text-indigo-900 md:text-3xl">
                    Máy tính y học
                </a>
            </div>

            <nav class="nav-menu flex space-x-2 md:space-x-4 w-full md:w-auto nav-scrollable md:order-3 md:flex-shrink-0">
                <a href="index.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Trang Chủ</a>
                <a href="cong-cu.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100 active-link">Công Cụ</a>
                <a href="gioi-thieu.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Giới thiệu</a>
                <a href="#lien-he" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Liên Hệ</a>
            </nav>

            <div class="search-bar-container w-full max-w-sm md:max-w-xs md:mx-4 md:order-2 md:flex-grow">
                <input type="text" id="toolSearch" placeholder="Tìm kiếm..." class="w-full p-2 border border-gray-300 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm">
            </div>
        </div>
    </header>

    <section class="py-2 md:py-4 bg-white rounded-lg shadow-inner mx-4 mt-2 md:mx-auto md:mt-4 md:max-w-4xl">
        <div class="container mx-auto px-2 sm:px-4">
            <a href="cong-cu.html" class="block w-max mb-2 bg-indigo-100 p-1 rounded-full text-indigo-700 hover:bg-indigo-200 transition duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
            </a>
            <h1 class="text-xl md:text-3xl font-bold text-center text-gray-800 mb-8">
                Thang điểm HAS-BLED
            </h1>

            <div class="bg-gray-50 p-4 sm:p-6 md:p-8 rounded-xl shadow-lg">
                <form id="hasbled-score-form" class="space-y-6">
                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">1. Huyết áp không kiểm soát (H - Huyết áp tâm thu > 160mmHg)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="hypertension" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Có (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="hypertension" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không (0 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">2. Chức năng thận/gan bất thường (A)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="renal_liver" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không có cả hai (0 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="renal_liver" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Chỉ một trong hai (thận HOẶC gan) (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="renal_liver" value="2" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Cả hai (thận VÀ gan) (2 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">3. Tiền sử đột quỵ (S)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="stroke" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Có (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="stroke" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không (0 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">4. Tiền sử chảy máu nặng (B)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="bleeding" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Có (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="bleeding" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không (0 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">5. INR không ổn định (L - TTR < 60%)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="labile_inr" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Có (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="labile_inr" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không (0 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">6. Tuổi > 65 (E)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="elderly" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Có (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="elderly" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không (0 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="block font-medium text-gray-700 mb-1">7. Sử dụng thuốc/rượu bia đồng thời (D - NSAIDs/thuốc kháng kết tập tiểu cầu HOẶC lạm dụng rượu)</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="drugs_alcohol" value="0" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Không có cả hai (0 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="drugs_alcohol" value="1" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-ring-indigo-500">
                                <span class="ml-2 text-gray-700">Chỉ một trong hai (thuốc HOẶC rượu) (1 điểm)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="drugs_alcohol" value="2" class="h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                                <span class="ml-2 text-gray-700">Cả hai (thuốc VÀ rượu) (2 điểm)</span>
                            </label>
                        </div>
                    </div>

                    <div class="mt-8 flex flex-col md:flex-row gap-4">
                        <button type="submit" id="calculateBtn" class="flex-1 bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 transform hover:scale-105 hover:bg-indigo-700">
                            Tính điểm
                        </button>
                        <button type="button" id="clearBtn" class="flex-1 bg-red-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 transform hover:scale-105 hover:bg-red-600">
                            Xóa Dữ Liệu
                        </button>
                    </div>
                </form>

                <div id="result-container" class="mt-8 p-4 sm:p-6 bg-gray-100 border border-gray-200 rounded-xl text-gray-700 leading-relaxed shadow-inner hidden">
                    <h3 class="text-2xl font-bold text-gray-800 text-center mb-6">Kết quả</h3>
                    <div class="flex flex-col md:flex-row justify-center items-center md:space-x-8 space-y-8 md:space-y-0">
                        <div class="w-full md:w-auto flex-1 text-center">
                            <p class="text-lg font-medium text-gray-600 mb-2">Tổng điểm HAS-BLED</p>
                            <div id="hasbled-score-display" class="score-box">0</div>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <p class="text-lg font-medium text-gray-600 mb-2">Đánh giá nguy cơ chảy máu chính</p>
                        <p id="evaluation-text" class="result-text text-indigo-700">Vui lòng chọn các mục trên để tính điểm.</p>
                    </div>
                </div>

                <div class="mt-8 p-4 sm:p-6 bg-gray-100 border border-gray-200 rounded-xl text-gray-700 leading-relaxed shadow-inner">
                    <h4 class="text-lg font-bold text-gray-800 mb-2">Giải thích thang điểm HAS-BLED và đánh giá nguy cơ</h4>
                    <p class="text-base">Thang điểm HAS-BLED được sử dụng để đánh giá nguy cơ chảy máu chính (major bleeding) hàng năm ở bệnh nhân rung nhĩ đang hoặc sẽ được điều trị bằng thuốc kháng đông đường uống. Tổng điểm cao hơn cho thấy nguy cơ chảy máu cao hơn.</p>
                    <p class="mt-2 text-base"><strong>Các yếu tố và cách tính điểm:</strong></p>
                    <ul class="list-disc list-inside ml-4 mt-2 space-y-1 text-base">
                        <li><strong>H</strong>ypertension (Huyết áp không kiểm soát - Huyết áp tâm thu > 160mmHg): 1 điểm</li>
                        <li><strong>A</strong>bnormal renal/liver function (Chức năng thận/gan bất thường): 1 điểm cho mỗi chức năng (tối đa 2 điểm)
                            <ul class="list-circle list-inside ml-4 text-base">
                                <li>Suy thận mãn (độ lọc cầu thận < 30ml/phút) hoặc đang lọc máu</li>
                                <li>Bệnh gan mãn tính hoặc xơ gan</li>
                            </ul>
                        </li>
                        <li><strong>S</strong>troke (Tiền sử đột quỵ): 1 điểm</li>
                        <li><strong>B</strong>leeding (Tiền sử chảy máu nặng): 1 điểm</li>
                        <li><strong>L</strong>abile INR (INR không ổn định - Thời gian trong khoảng điều trị INR < 60%): 1 điểm</li>
                        <li><strong>E</strong>lderly (> 65 tuổi): 1 điểm</li>
                        <li><strong>D</strong>rugs/alcohol (Sử dụng thuốc/rượu bia đồng thời): 1 điểm cho mỗi yếu tố (tối đa 2 điểm)
                            <ul class="list-circle list-inside ml-4 text-base">
                                <li>Sử dụng đồng thời NSAIDs hoặc thuốc kháng kết tập tiểu cầu</li>
                                <li>Lạm dụng rượu</li>
                            </ul>
                        </li>
                    </ul>
                    <p class="mt-4 text-base"><strong>Đánh giá nguy cơ chảy máu chính hàng năm dựa trên tổng điểm:</strong></p>
                    <ul class="list-disc list-inside ml-4 mt-2 space-y-1 text-base">
                        <li><strong>0 - 2 điểm:</strong> Nguy cơ thấp.</li>
                        <li><strong>≥ 3 điểm:</strong> Nguy cơ cao (nguy cơ chảy máu chính hàng năm > 3.4%), cần thận trọng và xem xét lợi ích/nguy cơ khi kê đơn thuốc kháng đông.</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">
                        <strong>Lưu ý:</strong> Thang điểm HAS-BLED là một công cụ hữu ích nhưng không phải là yếu tố duy nhất để đưa ra quyết định lâm sàng. Luôn cần xem xét toàn diện tình trạng bệnh nhân.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <footer id="lien-he" class="bg-gray-800 text-white py-8 text-center rounded-t-lg shadow-inner">
        <div class="container mx-auto px-4">
            <p>&copy; 2025 Máy tính y học. Mọi quyền được bảo lưu.</p>
            <p class="mt-2">
                Liên hệ: BS. Nguyễn Duy Toàn - Bệnh viện đa khoa Lâm Đồng
            </p>
            <p>
                Email: <a href="mailto:toannguyen284@gmail.com" class="text-indigo-400 hover:text-white transition duration-300">toannguyen284@gmail.com</a>
            </p>
            <div class="flex justify-center space-x-4 mt-4">
                <a href="chinh-sach-bao-mat.html" class="text-gray-400 hover:text-white transition duration-300">Chính sách bảo mật</a>
                <a href="dieu-khoan-dich-vu.html" class="text-gray-400 hover:text-white transition duration-300">Điều khoản dịch vụ</a>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('hasbled-score-form').addEventListener('submit', function(event) {
            event.preventDefault();

            let totalScore = 0;
            let allAnswered = true;

            const groups = ['hypertension', 'renal_liver', 'stroke', 'bleeding', 'labile_inr', 'elderly', 'drugs_alcohol'];

            groups.forEach(groupName => {
                const checked = document.querySelector(`input[name="${groupName}"]:checked`);
                if (!checked) {
                    allAnswered = false;
                } else {
                    totalScore += parseInt(checked.value);
                }
            });

            const resultContainer = document.getElementById('result-container');
            const scoreDisplay = document.getElementById('hasbled-score-display');
            const evaluationText = document.getElementById('evaluation-text');

            if (!allAnswered) {
                evaluationText.textContent = 'Vui lòng chọn tất cả các mục để tính điểm.';
                evaluationText.className = "result-text text-red-500";
                resultContainer.classList.remove('hidden');
                resultContainer.scrollIntoView({ behavior: 'smooth' });
                return;
            }

            scoreDisplay.textContent = totalScore;

            // Đánh giá nguy cơ dựa trên tổng điểm HAS-BLED
            if (totalScore >= 3) {
                evaluationText.textContent = `Tổng điểm HAS-BLED: ${totalScore}. Nguy cơ chảy máu chính HÀNG NĂM CAO (> 3.4%). Cần thận trọng khi sử dụng thuốc kháng đông.`;
                evaluationText.className = "result-text text-red-700";
            } else {
                evaluationText.textContent = `Tổng điểm HAS-BLED: ${totalScore}. Nguy cơ chảy máu chính HÀNG NĂM THẤP.`;
                evaluationText.className = "result-text text-green-700";
            }

            resultContainer.classList.remove('hidden');
            resultContainer.scrollIntoView({ behavior: 'smooth' });
        });

        document.getElementById('clearBtn').addEventListener('click', function() {
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
            });

            document.getElementById('hasbled-score-display').textContent = '0';
            document.getElementById('evaluation-text').textContent = 'Vui lòng chọn các mục trên để tính điểm.';
            document.getElementById('evaluation-text').className = "result-text text-indigo-700";
            document.getElementById('result-container').classList.add('hidden');
        });

        // JavaScript to dynamically adjust body padding based on fixed header height
        document.addEventListener('DOMContentLoaded', function() {
            const header = document.querySelector('header');
            const body = document.body;

            function adjustBodyPadding() {
                const headerHeight = header.offsetHeight;
                body.style.paddingTop = `${headerHeight}px`;
            }

            // Adjust padding on load and on window resize
            adjustBodyPadding();
            window.addEventListener('resize', adjustBodyPadding);
        });
    </script>
</body>
</html>