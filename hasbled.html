<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thang điểm HAS-BLED (Đánh giá nguy cơ chảy máu)</title>
    <!-- Thêm Favicon -->
    <link rel="icon" href="https://raw.githubusercontent.com/maytinhyhoc/trang-chu/main/logo.png" type="image/png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/maytinhyhoc/trang-chu/main/logo.png">
    <link rel="manifest" href="manifest.json">
    <!-- Tải Tailwind CSS từ CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        /* --- Styles Global --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            padding-top: 80px; /* Mặc định cho Desktop */
        }
        
        /* Responsive tweaks */
        @media (max-width: 767px) {
            body { 
                padding-top: 0px; /* Header ẩn trên mobile */
                padding-bottom: 80px; /* Chừa chỗ cho Bottom Nav */
            }
        }

        /* Custom style for the active/highlighted navigation link (Desktop) */
        .nav-item-highlight {
            background-color: #eef2ff;
            border-radius: 9999px;
            padding: 4px 12px;
            color: #4f46e5;
            font-weight: 500;
        }

        /* Styles cho Bottom Navigation */
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px 4px;
            color: #6b7280; /* gray-500 */
            transition: color 0.2s;
        }
        .bottom-nav-item.active {
            color: #4f46e5; /* indigo-600 */
        }
        .bottom-nav-item svg {
            width: 24px;
            height: 24px;
            margin-bottom: 2px;
        }
        .bottom-nav-item span {
            font-size: 10px;
            font-weight: 500;
        }

        .score-box {
            background-color: #eef2ff;
            color: #4f46e5;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 3rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            text-align: center;
            border: 1px solid #c7d2fe;
        }
        .result-text {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        /* Custom Radio Button Styling */
        input[type="radio"] {
            accent-color: #4f46e5;
            width: 1.25rem;
            height: 1.25rem;
        }
    </style>
</head>
<body class="text-gray-800 flex flex-col min-h-screen">

    <!-- === DESKTOP HEADER (Ẩn trên Mobile) === -->
    <header class="hidden md:block bg-white shadow-sm py-3 fixed top-0 w-full z-50">
        <div class="container mx-auto px-4 header-content flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center flex-shrink-0 w-auto">
                <a href="index.html" class="logo-text text-3xl font-bold text-indigo-700 rounded-lg transition duration-300 hover:text-indigo-900">
                    Máy tính y học
                </a>
            </div>

            <!-- Navigation Menu -->
            <nav class="nav-menu flex space-x-4">
                <a href="index.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Trang Chủ</a>
                <a href="cong-cu.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 nav-item-highlight">Công Cụ</a>
                <a href="gioi-thieu.html" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Giới thiệu</a>
                <a href="#lien-he" class="flex-shrink-0 text-base font-medium text-gray-700 hover:text-indigo-600 transition duration-300 px-3 py-1 rounded-full hover:bg-gray-100">Liên Hệ</a>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-4 md:py-8">
        
        <!-- Back Button & Title -->
        <div class="flex items-center justify-between mb-4 md:mb-6 pt-4 md:pt-0">
            <!-- Nút quay lại (Chỉ hiện Icon) -->
            <a href="cong-cu.html" class="flex-shrink-0 inline-flex items-center justify-center w-10 h-10 bg-white border border-gray-200 rounded-full text-indigo-600 hover:bg-indigo-50 hover:border-indigo-200 transition duration-300 shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
            </a>

            <!-- Tiêu đề (Căn giữa) -->
            <h1 class="text-xl md:text-3xl font-bold text-center text-gray-800 flex-grow px-2">
                Thang điểm HAS-BLED
            </h1>

            <!-- Spacer ảo để cân bằng layout (Căn giữa hoàn hảo) -->
            <div class="w-10 h-10 flex-shrink-0"></div>
        </div>

        <!-- Main Content Box -->
        <div class="mt-2 md:mt-8 bg-white rounded-lg shadow-lg p-3 md:p-8 max-w-4xl mx-auto">
            
            <div class="bg-gray-50 p-4 sm:p-6 md:p-8 rounded-xl border border-gray-100">
                <form id="hasbled-score-form" class="space-y-4 divide-y divide-gray-200">
                    
                    <!-- H -->
                    <div class="input-group py-3 first:pt-0">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">1. H</span> - Huyết áp không kiểm soát (HATT > 160mmHg)
                        </label>
                        <div class="flex space-x-6 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="hypertension" value="1">
                                <span class="ml-2 text-sm text-gray-700">Có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="hypertension" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không</span>
                            </label>
                        </div>
                    </div>

                    <!-- A -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">2. A</span> - Chức năng Thận/Gan bất thường
                        </label>
                        <div class="flex flex-col space-y-2 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="renal_liver" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="renal_liver" value="1">
                                <span class="ml-2 text-sm text-gray-700">Chỉ một (Thận <strong>HOẶC</strong> Gan)</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="renal_liver" value="2">
                                <span class="ml-2 text-sm text-gray-700">Cả hai (Thận <strong>VÀ</strong> Gan)</span>
                            </label>
                        </div>
                    </div>

                    <!-- S -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">3. S</span> - Tiền sử đột quỵ
                        </label>
                        <div class="flex space-x-6 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="stroke" value="1">
                                <span class="ml-2 text-sm text-gray-700">Có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="stroke" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không</span>
                            </label>
                        </div>
                    </div>

                    <!-- B -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">4. B</span> - Tiền sử chảy máu nặng
                        </label>
                        <div class="flex space-x-6 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="bleeding" value="1">
                                <span class="ml-2 text-sm text-gray-700">Có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="bleeding" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không</span>
                            </label>
                        </div>
                    </div>

                    <!-- L -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">5. L</span> - INR không ổn định (TTR < 60%)
                        </label>
                        <div class="flex space-x-6 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="labile_inr" value="1">
                                <span class="ml-2 text-sm text-gray-700">Có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="labile_inr" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không</span>
                            </label>
                        </div>
                    </div>

                    <!-- E -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">6. E</span> - Người cao tuổi (> 65 tuổi)
                        </label>
                        <div class="flex space-x-6 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="elderly" value="1">
                                <span class="ml-2 text-sm text-gray-700">Có</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="elderly" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không</span>
                            </label>
                        </div>
                    </div>

                    <!-- D -->
                    <div class="input-group py-3">
                        <label class="block text-sm font-medium text-gray-800 mb-2">
                            <span class="font-bold text-indigo-700">7. D</span> - Sử dụng thuốc / Rượu bia
                        </label>
                        <div class="flex flex-col space-y-2 ml-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="drugs_alcohol" value="0">
                                <span class="ml-2 text-sm text-gray-700">Không có cả hai</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="drugs_alcohol" value="1">
                                <span class="ml-2 text-sm text-gray-700">Chỉ một (Thuốc <strong>HOẶC</strong> Rượu)</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="drugs_alcohol" value="2">
                                <span class="ml-2 text-sm text-gray-700">Cả hai (Thuốc <strong>VÀ</strong> Rượu)</span>
                            </label>
                        </div>
                    </div>

                    <div class="mt-8 flex flex-col sm:flex-row gap-4 pt-4">
                        <button type="submit" id="calculateBtn" class="flex-1 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition duration-300 transform hover:-translate-y-0.5 hover:bg-indigo-700 flex items-center justify-center">
                            <i class="fa-solid fa-calculator mr-2"></i> Tính điểm
                        </button>
                        <button type="button" id="clearBtn" class="flex-1 bg-white text-red-500 border border-red-200 font-bold py-3 px-6 rounded-lg shadow-sm hover:shadow-md transition duration-300 hover:bg-red-50 flex items-center justify-center">
                            <i class="fa-solid fa-trash-can mr-2"></i> Xóa Dữ Liệu
                        </button>
                    </div>
                </form>

                <!-- Results -->
                <div id="result-container" class="mt-8 hidden animate-fade-in-up">
                    <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-6 text-center shadow-inner">
                        <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wide mb-3">Tổng điểm HAS-BLED</h3>
                        
                        <div id="hasbled-score-display" class="score-box mb-4 bg-white text-indigo-700">0</div>

                        <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-left">
                            <p class="text-sm font-bold text-gray-500 mb-1">Đánh giá nguy cơ:</p>
                            <p id="evaluation-text" class="result-text text-indigo-700 leading-relaxed">
                                Vui lòng chọn đầy đủ thông tin.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Explanation Text -->
                <div class="mt-8 p-4 sm:p-6 bg-white border border-gray-200 rounded-xl text-gray-700 text-sm leading-relaxed shadow-sm">
                    <h4 class="text-base font-bold text-gray-800 mb-3 border-b border-gray-100 pb-2">
                        <i class="fa-solid fa-circle-info text-indigo-500 mr-2"></i>Giải thích và Ý nghĩa
                    </h4>
                    <p class="mb-3">Thang điểm HAS-BLED đánh giá nguy cơ chảy máu chính hàng năm ở bệnh nhân rung nhĩ dùng thuốc chống đông.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs sm:text-sm">
                        <div class="bg-green-50 p-3 rounded border border-green-100">
                            <p class="font-bold text-green-800 mb-1">0 - 2 điểm: Nguy cơ Thấp/Trung bình</p>
                            <p class="text-green-700">Theo dõi định kỳ. Cân nhắc lợi ích vượt trội nguy cơ.</p>
                        </div>
                        <div class="bg-red-50 p-3 rounded border border-red-100">
                            <p class="font-bold text-red-800 mb-1">≥ 3 điểm: Nguy cơ Cao</p>
                            <p class="text-red-700">Nguy cơ chảy máu chính > 3.4%/năm. Cần thận trọng đặc biệt, kiểm soát chặt chẽ các yếu tố nguy cơ (HA, INR...).</p>
                        </div>
                    </div>
                    
                    <p class="mt-4 text-xs text-gray-500 italic">
                        *Lưu ý: Thang điểm này giúp cảnh báo và quản lý các yếu tố nguy cơ chảy máu có thể thay đổi được, không phải là lý do để chống chỉ định tuyệt đối thuốc chống đông nếu nguy cơ đột quỵ cao.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer id="lien-he" class="bg-gray-800 text-white py-8 text-center rounded-t-lg shadow-inner mt-auto">
        <div class="container mx-auto px-4">
            <p>&copy; 2025 Máy tính y học. Mọi quyền được bảo lưu.</p>
            <p class="mt-2">Liên hệ: BS. Nguyễn Duy Toàn - Bệnh viện đa khoa Lâm Đồng</p>
            <p>Email: <a href="mailto:toannguyen284@gmail.com" class="text-indigo-400 hover:text-white transition duration-300">toannguyen284@gmail.com</a></p>
            <div class="flex justify-center space-x-4 mt-4">
                <a href="chinh-sach-bao-mat.html" class="text-gray-400 hover:text-white transition duration-300">Chính sách bảo mật</a>
                <a href="dieu-khoan-dich-vu.html" class="text-gray-400 hover:text-white transition duration-300">Điều khoản dịch vụ</a>
            </div>
        </div>
    </footer>

    <!-- MOBILE BOTTOM NAVIGATION -->
    <nav class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-[0_-2px_10px_rgba(0,0,0,0.1)] z-50 flex justify-around py-2 pb-safe md:hidden">
        <!-- Trang chủ -->
        <a href="index.html" class="bottom-nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
            </svg>
            <span>Trang Chủ</span>
        </a>

        <!-- Công cụ (Active) -->
        <a href="cong-cu.html" class="bottom-nav-item active">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
            </svg>
            <span>Công Cụ</span>
        </a>

        <!-- Giới thiệu -->
        <a href="gioi-thieu.html" class="bottom-nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
            <span>Giới thiệu</span>
        </a>

        <!-- Liên hệ -->
        <a href="#lien-he" class="bottom-nav-item">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
            </svg>
            <span>Liên Hệ</span>
        </a>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Layout Adjustment ---
            const header = document.querySelector('header');
            const body = document.body;

            function adjustBodyPadding() {
                if (header && getComputedStyle(header).display !== 'none') {
                    const headerHeight = header.offsetHeight;
                    body.style.paddingTop = `${headerHeight}px`;
                } else {
                    body.style.paddingTop = '0px';
                }
            }

            adjustBodyPadding();
            window.addEventListener('resize', adjustBodyPadding);

            // --- Logic HAS-BLED ---
            const form = document.getElementById('hasbled-score-form');
            const resultContainer = document.getElementById('result-container');
            const scoreDisplay = document.getElementById('hasbled-score-display');
            const evaluationText = document.getElementById('evaluation-text');
            const clearBtn = document.getElementById('clearBtn');

            form.addEventListener('submit', function(event) {
                event.preventDefault();

                let totalScore = 0;
                let allAnswered = true;

                // Các nhóm radio cần kiểm tra
                const groups = ['hypertension', 'renal_liver', 'stroke', 'bleeding', 'labile_inr', 'elderly', 'drugs_alcohol'];

                groups.forEach(groupName => {
                    const checked = document.querySelector(`input[name="${groupName}"]:checked`);
                    if (!checked) {
                        allAnswered = false;
                    } else {
                        totalScore += parseInt(checked.value);
                    }
                });

                if (!allAnswered) {
                    evaluationText.innerHTML = '<i class="fa-solid fa-triangle-exclamation mr-1"></i> Vui lòng chọn tất cả các mục để tính điểm.';
                    evaluationText.className = "result-text text-red-500 font-bold";
                    resultContainer.classList.remove('hidden');
                    // Scroll to error
                    const headerHeight = document.querySelector('header')?.offsetHeight || 0;
                    const targetPos = resultContainer.getBoundingClientRect().top + window.pageYOffset - headerHeight - 20;
                    window.scrollTo({ top: targetPos, behavior: 'smooth' });
                    return;
                }

                scoreDisplay.textContent = totalScore;

                // Đánh giá nguy cơ dựa trên tổng điểm HAS-BLED
                let resultMessage = "";
                let resultClass = "";

                if (totalScore >= 3) {
                    resultMessage = `Nguy cơ chảy máu chính HÀNG NĂM CAO (> 3.4%). Cần thận trọng và theo dõi sát sao.`;
                    resultClass = "result-text text-red-700 font-bold";
                } else {
                    resultMessage = `Nguy cơ chảy máu chính HÀNG NĂM THẤP - TRUNG BÌNH.`;
                    resultClass = "result-text text-green-700 font-bold";
                }

                evaluationText.textContent = resultMessage;
                evaluationText.className = resultClass;

                resultContainer.classList.remove('hidden');
                
                // Scroll to result
                const headerHeight = document.querySelector('header')?.offsetHeight || 0;
                const targetPos = resultContainer.getBoundingClientRect().top + window.pageYOffset - headerHeight - 20;
                window.scrollTo({ top: targetPos, behavior: 'smooth' });
            });

            clearBtn.addEventListener('click', function() {
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });

                scoreDisplay.textContent = '0';
                evaluationText.textContent = 'Vui lòng chọn các mục trên để tính điểm.';
                evaluationText.className = "result-text text-gray-500";
                resultContainer.classList.add('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>